<!DOCTYPE html>

<html lang="EN">
    <head>
        <meta charset="UTF-8">
        <link rel="icon" type="image/x-icon" href="{{ url_for('static',filename='images/teemill.svg') }}">
        <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/styles.css') }}">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

        <script src="{{ url_for('static',filename='script/splash.js') }}"> </script>

        <title> Vengeful Vegetables </title>
    </head>
    <div class="splash">
        <div class="splash-content">
            <img src="{{ url_for('static',filename='images/teemill_full.svg') }}"/>
            <h1> Tap to Start </h1>
        </div>
    </div>
    <div id="camera-overlay">
        <button id="close-camera" style="position: absolute;"> Close </button>
        <iframe src="{{ url_for('static',filename='pages/arjs_scene.html') }}" width="100%" height="100%" frameBorder="0"></iframe>
    </div>
    <body style="margin: 0; overflow: hidden;">
        <nav>
            <img src="{{ url_for('static',filename='images/teemill.svg') }}">
            <h1> Vengeful Vegetables </h1>
        </nav>
        <main> <!-- THIS IS WHERE THE MAIN THINGY IS-->
            <div id="inputPrompt">
                <p>Enter a prompt:</p>
                <input type="text" id="promptInput" name="prompt">
            </div>
            <div id="main-frame">
                <img src="" id="displayedImage" width="100%" height="100%">
                <canvas id="drawingCanvas" width="100%" height="100%" style="box-shadow: none;">
                    <script src="{{ url_for('static',filename='script/index.js')}}"></script>
                </canvas>
                <!-- <img src="" id="displayedImage"> -->
            </div> <!-- PUT DRAWING CANVAS HERE-->
            <div id="button-box">
                <button id="gen-image-button"> Generate AI Image </button>
                <button id="search-image-button"> Search ClickASnap </button>
                <button id="open-camera"> Open Camera </button>
            </div>
        </main>
        <script>
            document.getElementById('gen-image-button').addEventListener('click', function(event) {
                event.preventDefault();

                const prompt = document.getElementById('promptInput').value;

                fetch('/process_prompt', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({prompt: prompt})
                })
                .then(response => {
                    if (response.ok) {
                    return response.text();
                } else {
                    console.error('Error fetching image from server');
                }})
                .then(text => {
                    document.getElementById('displayedImage').src = text; // Set the src attribute of the image
                    document.getElementById('displayedImage').style.display = "block";
                })
            })

            document.getElementById("open-camera").addEventListener("click", function(event) {
                document.getElementById("camera-overlay").style.display = "flex";
            })

            document.getElementById("close-camera").addEventListener("click", function(event) {
                document.getElementById("camera-overlay").style.display = "none";
            })
        </script>
    </body>
    <footer>

    </footer>
</html>